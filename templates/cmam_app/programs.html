{% extends "index.html" %}
{% load staticfiles %}
{% load i18n %}
{% block title %}Programs{% endblock title %}
{% block blockname %}ProgramApp{% endblock blockname %}
{% block content %}
      {% block programs %}
      <div class="right_col" role="main" ng-controller="pgrmCtrl">
        <!-- top tiles -->
        <div class="row tile_count">
          <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> {% trans "Rate of healing at STA" %}</span>
            <div class="count green">{% verbatim %}{{((cdsgnrl.gueri/(cdsgnrl.gueri+cdsgnrl.deces+cdsgnrl.abandon))*100).toFixed(2) | number: 0}}{% endverbatim %}%</div>
            <span class="count_bottom"><i class="green">
              <table class="table bg-success">
                <thead>
                  <tr>
                    <th>Prov</th>
                    <th>Dist</th>
                    <th>CDS</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{% verbatim %}
                    {{((cdsprov.gueri/(cdsprov.gueri+cdsprov.deces+cdsprov.abandon))*100).toFixed(2) | number: 0}}
                    {% endverbatim %}%</td>
                          <td>{% verbatim %}
                    {{((cdsdistr.gueri/(cdsdistr.gueri+cdsdistr.deces+cdsdistr.abandon))*100).toFixed(2) | number: 0}}
                    {% endverbatim %}%</td>
                          <td>{% verbatim %}
                    {{((cdscds.gueri/(cdscds.gueri+cdscds.deces+cdscds.abandon))*100).toFixed(2) | number: 0}}
                    {% endverbatim %}%</td>
                  </tr>
                </tbody>
                </table>
              </i>
            </span>
          </div>
          <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-clock-o"></i>{% trans "Death rate at STA" %}</span>
            <div class="count red">{% verbatim %}{{((cdsgnrl.deces/(cdsgnrl.gueri+cdsgnrl.deces+cdsgnrl.abandon))*100).toFixed(2) | number: 0}}{% endverbatim %}%</div>
            <span class="count_bottom"><i class="red">
              <table class="table bg-danger">
                <thead>
                  <tr>
                    <th>Prov</th>
                    <th>Dist</th>
                    <th>CDS</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{% verbatim %}
              {{((cdsprov.deces/(cdsprov.gueri+cdsprov.deces+cdsprov.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                    <td>{% verbatim %}
              {{((cdsdistr.deces/(cdsdistr.gueri+cdsdistr.deces+cdsdistr.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                    <td>{% verbatim %}
              {{((cdscds.deces/(cdscds.gueri+cdscds.deces+cdscds.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                  </tr>
                </tbody>
              </table>
              </i>
            </span>
          </div>
          <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> {% trans "Dropout rate at STA" %}</span>
            <div class="count green">{% verbatim %}{{((cdsgnrl.abandon/(cdsgnrl.gueri+cdsgnrl.deces+cdsgnrl.abandon))*100).toFixed(2) | number: 0}}{% endverbatim %}%</div>
            <span class="count_bottom"><i class="green">
              <table class="table bg-info">
                <thead>
                  <tr>
                    <th>Prov</th>
                    <th>Dist</th>
                    <th>CDS</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{% verbatim %}
              {{((cdsprov.abandon/(cdsprov.gueri+cdsprov.deces+cdsprov.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                    <td>{% verbatim %}
              {{((cdsdistr.abandon/(cdsdistr.gueri+cdsdistr.deces+cdsdistr.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                    <td>{% verbatim %}
              {{((cdscds.abandon/(cdscds.gueri+cdscds.deces+cdscds.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                  </tr>
                </tbody>
              </table>
            </i>
          </span>
          </div>
          <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> {% trans "Rate of healing at SST" %}</span>
            <div class="count">{% verbatim %}{{((hopitauxgnrl.gueri/(hopitauxgnrl.gueri+hopitauxgnrl.deces+hopitauxgnrl.abandon))*100).toFixed(2) | number: 0}}{% endverbatim %}%</div>
            <span class="count_bottom"><i class="green">
              <table class="table bg-success">
                <thead>
                  <tr>
                    <th>Prov</th>
                    <th>Dist</th>
                    <th>Hop</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{% verbatim %}
              {{((hopitauxprov.gueri/(hopitauxprov.gueri+hopitauxprov.deces+hopitauxprov.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                    <td>{% verbatim %}
              {{((hopitauxdistr.gueri/(hopitauxdistr.gueri+hopitauxdistr.deces+hopitauxdistr.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
              <td>{% verbatim %}
              {{((hopitauxcds.gueri/(hopitauxcds.gueri+hopitauxcds.deces+hopitauxcds.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                  </tr>
                </tbody>
              </table>
              </i>
            </span>
          </div>
          <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> {% trans "Death rate at SST" %}</span>
            <div class="count red">{% verbatim %}{{((hopitauxgnrl.deces/(hopitauxgnrl.gueri+hopitauxgnrl.deces+hopitauxgnrl.abandon))*100).toFixed(2) | number: 0}}{% endverbatim %}%</div>
            <span class="count_bottom"><i class="red">
              <table class="table bg-danger">
                <thead>
                  <tr>
                    <th>Prov</th>
                    <th>Dist</th>
                    <th>Hop</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{% verbatim %}
              {{((hopitauxprov.deces/(hopitauxprov.gueri+hopitauxprov.deces+hopitauxprov.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                    <td>{% verbatim %}
              {{((hopitauxdistr.deces/(hopitauxdistr.gueri+hopitauxdistr.deces+hopitauxdistr.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
              <td>{% verbatim %}
              {{((hopitauxcds.deces/(hopitauxcds.gueri+hopitauxcds.deces+hopitauxcds.abandon))*100).toFixed(2) | number: 0}}
              {% endverbatim %}%</td>
                  </tr>
                </tbody>
              </table>
                </i>
            </span>
          </div>
          <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> {% trans "Dropout rate at SST" %}</span>
            <div class="count">{% verbatim %}{{((hopitauxgnrl.abandon/(hopitauxgnrl.gueri+hopitauxgnrl.deces+hopitauxgnrl.abandon))*100).toFixed(2) | number: 0}}{% endverbatim %}%</div>
            <span class="count_bottom"><i class="green">
              <table class="table bg-info">
                  <thead>
                    <tr>
                      <th>Prov</th>
                      <th>Dist</th>
                      <th>Hop</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td >{% verbatim %}
                {{((hopitauxprov.abandon/(hopitauxprov.gueri+hopitauxprov.deces+hopitauxprov.abandon))*100).toFixed(2) | number: 0}}
                {% endverbatim %}%</td>
                      <td>{% verbatim %}
                {{((hopitauxdistr.abandon/(hopitauxdistr.gueri+hopitauxdistr.deces+hopitauxdistr.abandon))*100).toFixed(2) | number: 0}}
                {% endverbatim %}%</td>
                <td>{% verbatim %}
                {{((hopitauxcds.abandon/(hopitauxcds.gueri+hopitauxcds.deces+hopitauxcds.abandon))*100).toFixed(2) | number: 0}}
                {% endverbatim %}%</td>
                    </tr>
                  </tbody>
                </table>
              </i>
            </span>
          </div>
        </div>
        <!-- /top tiles -->
        <div class="row">
          <div class="col-md-12 col-xs-12">
            <div class="x_panel">
              <div class="x_content">
                <br />
                {% block search_form %}
                <form role="form" class="side-form">
                  <!-- Province -->
                  <div class="col-md-2 col-sm-12 col-xs-12 form-group">
                    <label>Province</label>
                    <select id="ddprovince" class="form-control"  ng-model="province" ng-options="x.name for x in provinces track by x.code" ng-change="update_province()">
                    <option value="">-------</option>
                    </select>
                  </div>

                  <!-- District -->
                  <div class="col-md-3 col-sm-12 col-xs-12 form-group">
                    <label>District</label>
                    <select id="districtselect" class="form-control"  ng-model="dashboard.district" ng-options="x.name for x in districts track by x.code"  ng-change="update_district()" >
                        <option value="">-------</option>
                    </select>
                  </div>

                  <!-- CDS -->
                    <div class="col-md-3 col-sm-12 col-xs-12 form-group">
                      <label>CDS</label>
                      <select class="form-control"  ng-model="district" ng-options="x.name for x in districts track by x.code"  ng-change="update_district()" >
                      <option value="">-------</option>
                      </select>
                    </div>
                  <!-- dates -->
                    <div class="col-md-2 col-sm-12 col-xs-12 form-group">
                        <label for="dstartdate">{% trans "Start Date" %}:</label>
                        <div class="input-group date" data-provide="datepicker">
                            <input type="text" id="startdate" class="form-control datepicker" readonly="readonly" ng-model="startdate" ng-change="get_by_date()" style="position: relative; z-index: 100000;">
                            <div class="input-group-addon">
                                <span class="glyphicon glyphicon-th"></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2 col-sm-12 col-xs-12 form-group">
                        <label for="dendtdate">{% trans "End Date" %}:</label>
                        <div class="input-group date" data-provide="datepicker">
                            <input type="text" id="endtdate" class="form-control datepicker" readonly="readonly" ng-model="enddate" ng-change="get_by_date()" style="position: relative; z-index: 100000;">
                            <div class="input-group-addon">
                                <span class="glyphicon glyphicon-th"></span>
                            </div>
                        </div>
                    </div>
                </form>
                {% endblock search_form %}
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel">
              <div class="x_content">


                <div class="" role="tabpanel" data-example-id="togglable-tabs">
                  <ul id="myTab" class="nav nav-tabs bar_tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#tab_content1" id="sta-tab" role="tab" data-toggle="tab" aria-expanded="true">STA</a>
                    </li>
                    <li role="presentation" class=""><a href="#tab_content2" role="tab" id="sst-tab" data-toggle="tab" aria-expanded="false">SST</a>
                    </li>
                  </ul>
                  <div id="myTabContent" class="tab-content" ng-controller="ExportCtrl">
                    <div role="tabpanel" class="tab-pane fade active in" id="tab_content1" aria-labelledby="home-tab">
                      <table  class="table fixed table-bordered table-hover"  data-toggle="table" datatable="ng" dt-options="dtOptions" >
                          <thead class="thead-default">
                            <tr>
                              <th rowspan="2">Week</th>
                              <th rowspan="2">Total debut semaine</th>
                              <th colspan="3">Nouvelles Admissions</th>
                              <th rowspan="2">Re-admission après Abandon</th>
                              <th rowspan="2">Transfert interne</th>
                              <th rowspan="2">Total Admissions</th>
                              <th colspan="5">Sorties</th>
                              <th rowspan="2">Total decharge</th>
                              <th rowspan="2">Total Fin semaine</th>
                            </tr>
                            <tr>
                              <th>P/T&lt;-3z,70%, PB&lt;115mm ou PB&lt;180mm </th>
                              <th>Oeudeme</th>
                              <th>Rechute</th>
                              <th>Gueri</th>
                              <th>Deces</th>
                              <th>Abandon</th>
                              <th>Non repondant</th>
                              <th>Transfert iterne</th>
                            </tr>
                          </thead>
                          <tbody >
                            {% verbatim %}
                            <tr ng-repeat="(x, y) in lescds  ">
                              <td>{{x}}</td>
                              <td>{{y.total_debut_semaine}}</td>
                              <td>{{y.ptb}}</td>
                              <td>{{y.oedemes}}</td>
                              <td>{{y.rechute }}</td>
                              <td>{{y.readmission }}</td>
                              <td>{{y.transfert_interne_i }}</td>
                              <td>{{y.ptb + y.oedemes + y.rechute + y.readmission + y.transfert_interne_i }}</td>
                              <td>{{y.gueri }}</td>
                              <td>{{y.deces }}</td>
                              <td>{{y.abandon }}</td>
                              <td>{{y.non_repondant }}</td>
                              <td>{{y.transfert_interne_o }}</td>
                              <td>{{y.gueri + y.deces + y.abandon + y.non_repondant + y.transfert_interne_o }}</td>
                              <td>{{(y.total_debut_semaine + y.ptb + y.oedemes + y.rechute + y.readmission + y.transfert_interne_i) - (y.gueri + y.deces + y.abandon + y.non_repondant +y.transfert_interne_0) }}</td>
                            </tr>
                            <tr class="success">
                              <td><b>Weeks</b></td>
                              <td><b>{{sommecds.total_debut_semaine || 0}}</b> </td>
                              <td><b>{{sommecds.ptb || 0}}</b></td>
                              <td><b>{{sommecds.oedemes || 0}}</b></td>
                              <td><b>{{sommecds.rechute || 0}}</b></td>
                              <td><b>{{sommecds.readmission || 0}}</b></td>
                              <td><b>{{sommecds.transfert_interne_i || 0}}</b></td>
                              <td><b>{{sommecds.ptb + sommecds.oedemes + sommecds.rechute + sommecds.readmission + sommecds.transfert_interne_i  || 0}}</b></td>
                              <td><b>{{sommecds.gueri || 0}}</b></td>
                              <td><b>{{sommecds.deces || 0}}</b></td>
                              <td><b>{{sommecds.abandon || 0}}</b></td>
                              <td><b>{{sommecds.non_repondant || 0}}</b></td>
                              <td><b>{{sommecds.transfert_interne_o || 0}}</b></td>
                              <td><b>{{sommecds.gueri + sommecds.deces + sommecds.abandon + sommecds.non_repondant + sommecds.transfert_interne_o  || 0}}</b></td>
                              <td><b>{{(sommecds.total_debut_semaine + sommecds.ptb + sommecds.oedemes + sommecds.rechute + sommecds.readmission + sommecds.transfert_interne_i) - (sommecds.gueri + sommecds.deces + sommecds.abandon + sommecds.non_repondant + sommecds.transfert_interne_o)  || 0}}</b></td>
                            </tr>
                            {% endverbatim %}
                          </tbody>
                        </table>
                    </div>
                    <div role="tabpanel" class="tab-pane fade" id="tab_content2" aria-labelledby="profile-tab">
                      <table class="table fixed table-bordered table-hover" data-toggle="table" datatable="ng" dt-options="dtOptions" id="tblSST" >
                                <thead class="thead-default">
                                  <tr>
                                    <th rowspan="2">Week</th>
                                    <th rowspan="2">Total debut de semaine</th>
                                    <th colspan="3">Nouvelles Admissions</th>
                                    <th rowspan="2">Re-admission après Abandon (&lt;2mois)</th>
                                    <th rowspan="2">Transfert interne</th>
                                    <th rowspan="2">Total des Admissions</th>
                                    <th colspan="4">Sorties</th>
                                    <th rowspan="2">Total decharge</th>
                                    <th rowspan="2">Total Fin de semaine</th>
                                  </tr>
                                  <tr>
                                    <th>P/T&lt;-3z,70%, PB&lt;115mm ou PB&lt;180mm </th>
                                    <th>Oeudeme</th>
                                    <th>Rechute</th>
                                    <th>Traité avec succès</th>
                                    <th>Deces</th>
                                    <th>Abandons</th>
                                    <th>Non repondant</th>
                                  </tr>
                                </thead>
                                <tbody >
                                  {% verbatim %}
                                  <tr ng-repeat="(x, y) in leshopitaux" class="selectedcolumndata" >
                                    <td>{{x}}</td>
                                    <td>{{y.total_debut_semaine}}</td>
                                    <td>{{y.ptb}}</td>
                                    <td>{{y.oedemes}}</td>
                                    <td>{{y.rechute}}</td>
                                    <td>{{y.readmission}}</td>
                                    <td>{{y.transfert_interne_i}}</td>
                                    <td>{{y.ptb + y.oedemes + y.rechute + y.readmission + y.transfert_interne }}</td>
                                    <td>{{y.gueri}}</td>
                                    <td>{{y.deces}}</td>
                                    <td>{{y.abandon}}</td>
                                    <td>{{y.non_repondant}}</td>
                                    <td>{{y.gueri + y.deces + y.abandon + y.non_repondant }}</td>
                                    <td>{{(y.total_debut_semaine + y.ptb + y.oedemes + y.rechute + y.readmission + y.transfert_interne) - (y.gueri + y.deces + y.abandon + y.non_repondant)}}</td>
                                  </tr>
                                  <tr class="success">
                                    <td><b>Weeks</b></td>
                                    <td><b>{{sommehopitaux.total_debut_semaine || 0}}</b></td>
                                    <td><b>{{sommehopitaux.ptb || 0}}</b></td>
                                    <td><b>{{sommehopitaux.oedemes || 0}}</b></td>
                                    <td><b>{{sommehopitaux.rechute || 0}}</b></td>
                                    <td><b>{{sommehopitaux.readmission || 0}}</b></td>
                                    <td><b>{{sommehopitaux.transfert_interne_i || 0}}</b></td>
                                    <td><b>{{sommehopitaux.ptb + sommehopitaux.oedemes + sommehopitaux.rechute + sommehopitaux.readmission + sommehopitaux.transfert_interne  || 0}}</b></td>
                                    <td><b>{{sommehopitaux.gueri || 0}}</b></td>
                                    <td><b>{{sommehopitaux.deces || 0}}</b></td>
                                    <td><b>{{sommehopitaux.abandon || 0}}</b></td>
                                    <td><b>{{sommehopitaux.non_repondant || 0}}</b></td>
                                    <td><b>{{sommehopitaux.gueri + sommehopitaux.deces + sommehopitaux.abandon + sommehopitaux.non_repondant || 0}}</b></td>
                                    <td><b>{{ (sommehopitaux.total_debut_semaine + sommehopitaux.ptb + sommehopitaux.oedemes + sommehopitaux.rechute + sommehopitaux.readmission + sommehopitaux.transfert_interne) - (sommehopitaux.gueri + sommehopitaux.deces + sommehopitaux.abandon + sommehopitaux.non_repondant) || 0}}</b></td>
                                  </tr>
                                  {% endverbatim %}
                                </tbody>
                              </table>
                    </div>
                  </div>
                </div>

              </div>
            </div>
          </div>
        </div>
      </div>
      {% endblock programs %}
{% endblock content %}

{% block custom_js %}
  <script type="text/javascript" src="{% static 'js/angular-sanitize.min.js' %}"></script>
  <script src="{% static "js/jquery/jquery.dataTables.min.js" %}"></script>
  <script src="{% static "js/angular-datatables.min.js" %}"></script>
  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static "css/angular-datatables.min.css" %}">
  <link rel="stylesheet" href="{% static "css/buttons.dataTables.min.css" %}">
  <script src="{% static "js/dataTables.buttons.min.js" %}"></script>
  <script src="{% static "js/buttons.colVis.min.js" %}"></script>
  <script src="{% static "js/buttons.flash.min.js" %}"></script>
  <script src="{% static "js/buttons.html5.min.js" %}"></script>
  <script src="{% static "js/buttons.print.min.js" %}"></script>
  <script src="{% static "js/angular-datatables.buttons.min.js" %}"></script>
  <!-- CMAM based Js -->
  <script src="{% static 'js/cmam-programs.js' %}"></script>
{% endblock custom_js %}